.\" Copyright (c) 2006 Pierre-Yves Ritschard <pyr@openbsd.org>
.\" Copyright (c) 2008 Vincent Bernat <bernat@luffy.cx>
.\"
.\" Permission to use, copy, modify, and distribute this software for any
.\" purpose with or without fee is hereby granted, provided that the above
.\" copyright notice and this permission notice appear in all copies.
.\"
.\" THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
.\" WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
.\" MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
.\" ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
.\" WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
.\" ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
.\" OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
.\"
.Dd $Mdocdate: August 21 2008 $
.Dt LLDPD 8
.Os
.Sh NAME
.Nm lldpd
.Nd LLDP daemon
.Sh SYNOPSIS
.Nm
.Op Fl dvxcsei
.Op Fl m Ar management
.Op Fl p Ar probe time
.Op Fl M Ar class
.Op Fl L Ar location
.Sh DESCRIPTION
.Nm
is a daemon able to receive and send
.Em LLDP
frames. The Link Layer Discovery Protocol is a vendor-neutral Layer 2
protocol that allows a network device to advertise its identity and
capabilities on the local network.
.Pp
.Nm
also implements an SNMP subagent using AgentX protocol to interface to
a regular SNMP agent like Net-SNMP. To enable this subagent, you need
something like that in your
.Xr snmpd.conf 5 :
.Bd -literal -offset indent
master agentx
.Ed
.Pp
This daemon implements both reception and sending. It will collect
various information to send LLDP frames to all Ethernet interfaces,
including management address, speed and VLAN names.
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl d
Do not daemonize.
If this option is specified,
.Nm
will run in the foreground and log to
.Em stderr .
This option can be specified many times to increase verbosity.
.It Fl v
Listen on VLAN as well. This option might be needed if your equipment
send frames on VLAN instead of physical interface. This option enables
.Nm
to receive frames on VLAN interfaces as well. If you don't need this
option, do not set it.
.It Fl x
Enable SNMP subagent
With this option,
.Nm
will enable an SNMP subagent using AgentX protocol. This allows to get
information about local system and remote systems through SNMP.
.It Fl c
Enable the support of CDP protocol to deal with Cisco routers that do
not speak LLDP.
.It Fl f
Enable the support of FDP protocol to deal with Foundry routers that do
not speak LLDP.
.It Fl s
Enable the support of SONMP protocol to deal with Nortel routers and
switches that do not speak LLDP.
.It Fl e
Enable the support of EDP protocol to deal with Extreme routers and
switches that do not speak LLDP.
.It Fl m Ar management
Specify the management address of this system.
.Nm
only sends one management address. It will use the first one that it
finds or the one that you specify with this option. This option can
use wildcards.
.It Fl p Ar probe time
Specify the time to wait (in seconds) before accepting a given
protocol. This time will be used by
.Nm
to detect false positives like SONMP frames running through a switch
only supporting CDP. This value is only used when multiple protocols
are enabled.
.It Fl M Ar class
Enable emission of LLDP-MED frame. The class should be one of the
following value:
.Bl -tag -width "0:XX" -compact
.It Sy 1
Generic Endpoint (Class I)
.It Sy 2
Media Endpoint (Class II)
.It Sy 3
Communication Device Endpoints (Class III)
.It Sy 4
Network Connectivity Device
.El
.It Fl i
Disable LLDP-MED inventory TLV transmission.
.Nm
will still receive (and publish using SNMP if enabled) those LLDP-MED
TLV but will not send them. Use this option if you don't want to
transmit sensible information like serial numbers.
.It Fl L Ar location
Enable the transmission of LLDP-MED location TLV. This option can be
repeated several times to enable the transmission of the location in
several formats. Several formats are accepted:
.Bl -tag -width "XX"
.It Em Coordinate based location
The format of
.Ar location
is
.Ar 1:48.85667:N:2.2014:E:117.47:m:1
The first digit is always
.Ar 1 .
It is followed by the latitude, a letter for the direction (
.Ar E
or
.Ar W
for East or West), the longitude and a letter for the direction (
.Ar N
or
.Ar S
). The next figure is the altitude. It can be expressed in meters (the
next letter is then
.Ar m
) or in floors (the letter should be
.Ar f
). The last digit is the datum. It can either be
.Ar 1
(WGS84), 
.Ar 2
(NAD83) or
.Ar 3
(NAD83/MLLW).
.It Em Civic address
The location can be expressed as an address. The format of the
location is then
.Ar 2:FR:6:Commercial Rd:3:Roseville:19:4
The first digit is always
.Ar 2 .
The next two letters are the country code. Then, arguments are paired
to form the address. The first member of the pair is a digit
indicating the type of the second member. Here is the list of
valid types:
.Bl -tag -width "XXXX." -compact
.It Sy 0
Language
.It Sy 1
National subdivisions
.It Sy 2
County, parish, district
.It Sy 3
City, township
.It Sy 4
City division, borough, ward
.It Sy 5
Neighborhood, block
.It Sy 6
Street
.It Sy 16
Leading street direction
.It Sy 17
Trailing street suffix
.It Sy 18
Street suffix
.It Sy 19
House number
.It Sy 20
House number suffix
.It Sy 21
Landmark or vanity address
.It Sy 22
Additional location info
.It Sy 23
Name
.It Sy 24
Postal/ZIP code
.It Sy 25
Building
.It Sy 26
Unit
.It Sy 27
Floor
.It Sy 28
Room number
.It Sy 29
Place type
.It Sy 128
Script
.El
.It ECS ELIN
This is a numerical string using for setting up emergency call. The
format of the location is then the following:
.Ar 3:0000000911
where the first digit should be
.Ar 3
and the second argument is the ELIN number.
.El
.Pp
Locations set using this option are set for all ports. There is
currently no way to affect different locations to different
ports. Using this TLV, network connectivity devices usually advertise
the location of a class III device. Since it is unlikely that all
devices are in the same location, the location TLV should be different
for each port. This is not possible actually.
.Pp
Therefore, this option is likely to be removed in the future and will
moved into
.Xr lldpctl 8 .
.El
.Sh FILES
.Bl -tag -width "/var/run/lldpd.socketXX" -compact
.It /var/run/lldpd.socket
Unix-domain socket used for communication with
.Xr lldpctl 8 .
.El
.Sh SEE ALSO
.Xr lldpctl 8 ,
.Xr snmpd 8
.Sh HISTORY
The
.Nm
program is inspired from a preliminary work of Reyk Floeter.
.Sh AUTHORS
.An -nosplit
The
.Nm
program was written by
.An Pierre-Yves Ritschard Aq pyr@openbsd.org ,
and
.An Vincent Bernat Aq bernat@luffy.cx .
